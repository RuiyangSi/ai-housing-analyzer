# 🏠 AI 驱动的智能房价分析系统

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.11+-blue.svg" alt="Python">
  <img src="https://img.shields.io/badge/Flask-3.1.2-green.svg" alt="Flask">
  <img src="https://img.shields.io/badge/AI-DeepSeek--V3-purple.svg" alt="AI">
  <img src="https://img.shields.io/badge/ECharts-5.4.3-red.svg" alt="ECharts">
  <img src="https://img.shields.io/badge/Data-70万+条-orange.svg" alt="Data">
</p>

<p align="center">
  <b>基于大语言模型的个性化购房决策支持系统</b><br>
  <sub>🎓 Python 课程大作业 | 多模态 AI + 3D 可视化 + 真实数据</sub>
</p>

---

## 📖 目录

- [项目简介](#-项目简介)
- [系统架构](#-系统架构)
- [核心功能](#-核心功能)
- [技术创新点](#-技术创新点)
- [快速启动](#-快速启动)
- [项目结构](#-项目结构)
- [技术栈](#-技术栈)
- [数据说明](#-数据说明)
- [API 接口](#-api-接口)
- [演示截图](#-演示截图)
- [常见问题](#-常见问题)

---

## 📋 项目简介

本项目是一个 **AI 驱动的智能房价分析系统**，旨在为购房者提供数据驱动的决策支持。系统整合了 **70万+ 条真实房产成交数据**，结合 **DeepSeek-V3 大语言模型**，实现了从数据分析、趋势预测到购房建议的全流程智能化。

### 🎯 项目目标

| 目标 | 实现方式 |
|------|---------|
| 让数据"说话" | 多维度可视化 + AI 自动解读 |
| 个性化服务 | 三种用户角色 + 定制化分析视角 |
| 辅助决策 | AI 策略规划 + 价格预测 + 购房建议 |
| 降低门槛 | 自然语言交互 + 直观的 3D 展示 |

---

## 🏗 系统架构

```
┌─────────────────────────────────────────────────────────────────┐
│                         前端展示层                               │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐   │
│  │  首页   │ │城市分析 │ │ 3D地图  │ │AI预测   │ │策略规划 │   │
│  └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘   │
└───────┼──────────┼──────────┼──────────┼──────────┼───────────┘
        │          │          │          │          │
        ▼          ▼          ▼          ▼          ▼
┌─────────────────────────────────────────────────────────────────┐
│                      Flask 后端服务层                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ DataManager  │  │ AI Assistant │  │ Predictor    │          │
│  │  数据管理器   │  │  AI 助手     │  │  预测引擎    │          │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘          │
│         │                 │                 │                   │
│  ┌──────┴───────┐  ┌──────┴───────┐  ┌──────┴───────┐          │
│  │ Analyzer     │  │ ImageGen     │  │ Strategy     │          │
│  │  分析引擎    │  │  图像生成    │  │  策略规划    │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└───────────────────────────┬─────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        ▼                   ▼                   ▼
  ┌──────────┐       ┌──────────────┐    ┌──────────┐
  │ CSV 数据 │       │ DeepSeek-V3 │    │ 配置文件 │
  │ 70万+条  │       │   AI 模型   │    │  JSON    │
  └──────────┘       └──────────────┘    └──────────┘
```

---

## ✨ 核心功能

### 1️⃣ AI 智能对话助手
- 基于 DeepSeek-V3 的自然语言交互
- 实时数据上下文感知
- 流式响应，体验流畅
- 支持多轮对话记忆

### 2️⃣ 城市深度分析
- 价格走势、成交分布、区域对比
- 专业图表：K线图、箱线图、雷达图
- **AI 自动解读**每张图表的含义

### 3️⃣ 3D 房价地图
- ECharts GL 3D 柱状图可视化
- 时间轴动画（2023-2025）
- 四种视图：价格/成交量/涨跌幅/单价
- 360° 交互旋转

### 4️⃣ AI 房价预测
- **双轨预测系统**：统计模型 + AI 预测
- 置信区间可视化
- 月度预测明细
- 关键因素分析

### 5️⃣ AI 购房策略规划
- 4 步问卷收集需求
- AI 生成个性化购房方案
- Top 5 区域推荐
- 贷款方案自动计算

### 6️⃣ AI 创意图像工作室
- 梦想家园可视化
- 装修风格效果图
- 生活场景想象

### 7️⃣ 全国城市对比
- 多城市横向对比
- 投资价值排名
- AI 综合分析建议

### 8️⃣ 用户角色系统
| 角色 | 分析侧重 | 适用人群 |
|------|---------|---------|
| 🏠 首次购房者 | 性价比、政策、刚需 | 首次购房的年轻人 |
| 💰 投资顾问 | ROI、增值、风险 | 房产投资者 |
| 🏡 改善型 | 置换、品质、学区 | 换房改善需求 |

---

## 🚀 技术创新点

### 1. 数据-程序解耦架构

```
配置化数据管理，零代码扩展新城市：
├─ config.json 统一管理数据源
├─ 新增城市只需添加 CSV + 配置项
└─ 系统自动加载，无需修改代码
```

### 2. 可插拔的 AI 模型层

```
模型无关设计，能力随模型升级自动增强：
├─ 遵循 OpenAI API 标准
├─ 支持切换：DeepSeek / GPT-4 / Claude / Qwen
└─ 配置文件一键切换，业务代码无需改动
```

### 3. 多模态 AI 深度融合

```
突破传统数据系统的文本局限：
├─ 文本生成：智能问答、分析报告、购房建议
├─ 图像生成：梦想家园、装修效果、生活场景
└─ 结构化提取：从 AI 响应提取数据绘制图表
```

### 4. 角色化个性分析引擎

```
基于用户画像的差异化服务：
├─ 动态提示词工程：根据角色调整分析视角
├─ 内容智能过滤：屏蔽无关信息
└─ 全局角色同步：一次设置，全站生效
```

### 5. 真实可信数据基座

```
70万+ 真实成交记录：
├─ 北京：435,008 条
├─ 武汉：241,506 条
├─ 厦门：38,238 条
└─ 时间跨度：2018-2025 年
```

---

## 🛠 快速启动

### 环境要求

- Python 3.11+
- 现代浏览器（支持 WebGL）

### 一键启动（推荐）

```bash
# 克隆项目
git clone https://github.com/RuiyangSi/ai-housing-analyzer.git
cd ai-housing-analyzer

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt

# 启动服务（已内置 API Key，可直接运行）
./start.sh
```

> 💡 `start.sh` 脚本已包含默认 API Key，可直接运行体验所有功能！

### 使用自己的 API Key（可选）

如果你想使用自己的 DeepSeek API Key：

```bash
# 复制配置文件
cp env.example .env

# 编辑 .env，填入你的 Key
DEEPSEEK_API_KEY=sk-your-own-api-key

# 启动
./start.sh
```

> 🔑 获取 API Key：https://platform.siliconflow.cn/

### 访问系统

1. 打开浏览器访问：**http://localhost:5001**
2. 注册账号并选择角色
3. 开始探索！

---

## 📁 项目结构

```
ai-housing-analyzer/
│
├── 📄 核心应用
│   ├── app.py                    # Flask 主应用入口
│   ├── ai_assistant.py           # AI 对话助手模块
│   ├── ai_image_generator.py     # AI 图像生成模块
│   ├── price_predictor.py        # 房价预测引擎
│   ├── housing_analyzer.py       # 数据分析引擎
│   ├── intelligent_analyzer.py   # 智能分析服务
│   ├── national_comparator.py    # 全国对比模块
│   ├── strategy_analyzer.py      # 策略规划引擎
│   └── process_data.py           # 数据预处理脚本
│
├── 📊 数据目录
│   └── data/
│       ├── raw/                  # 原始 Excel 数据
│       └── processed/            # 处理后的 CSV 数据
│
├── 🎨 前端资源
│   ├── templates/                # HTML 模板 (10 个页面)
│   │   ├── home.html             # 首页
│   │   ├── analysis.html         # 城市分析
│   │   ├── map_3d.html           # 3D 地图
│   │   ├── price_prediction.html # 房价预测
│   │   ├── strategy_planner.html # 策略规划
│   │   ├── ai_image_studio.html  # 图像工作室
│   │   ├── national_comparison.html # 全国对比
│   │   └── ...
│   │
│   └── static/
│       ├── css/                  # 样式文件
│       └── js/                   # JavaScript 逻辑
│
├── 📚 文档
│   └── docs/                     # 使用文档
│
├── 🔧 配置
│   ├── config.json               # 城市数据配置
│   ├── requirements.txt          # Python 依赖
│   └── start.sh                  # 启动脚本
│
└── 📝 说明
    └── README.md                 # 项目说明（本文件）
```

---

## 🔧 技术栈

### 后端

| 技术 | 版本 | 用途 |
|------|------|------|
| Python | 3.11+ | 主语言 |
| Flask | 3.1.2 | Web 框架 |
| Pandas | 2.3.3 | 数据处理 |
| NumPy | 2.3.5 | 数值计算 |
| Requests | 2.32.5 | HTTP 请求 |

### 前端

| 技术 | 版本 | 用途 |
|------|------|------|
| HTML5/CSS3/JS | - | 基础框架 |
| ECharts | 5.4.3 | 2D 图表 |
| ECharts GL | 2.0.9 | 3D 可视化 |
| Chart.js | 4.4.0 | 辅助图表 |

### AI

| 技术 | 说明 |
|------|------|
| DeepSeek-V3 | 大语言模型 |
| SiliconFlow API | API 服务商 |
| Prompt Engineering | 提示词工程 |

---

## 📊 数据说明

### 数据规模

| 城市 | 记录数 | 平均价格 | 平均单价 | 时间范围 |
|------|--------|---------|---------|----------|
| 北京 | 184,945 | 457.81万 | 54,932元/㎡ | 2023-2025 |
| 武汉 | 119,946 | 134.55万 | 12,784元/㎡ | 2023-2025 |
| 厦门 | 16,874 | 304.13万 | 32,376元/㎡ | 2023-2025 |
| **总计** | **321,765** | - | - | - |

### 数据字段

**必须字段（3个）**
```
成交日期, 区域, 成交价（万元）
```

**推荐字段（4个）** - 功能更完整
```
成交日期, 区域, 成交价（万元）, 面积（m²）
```
> 💡 `成交单价 = 成交价 ÷ 面积`，有面积即可自动计算

**完整字段（10个）** - 当前系统使用
```
成交日期, 城市, 区域, 商圈, 小区, 户型, 
面积（m²）, 挂牌价（万元）, 成交价（万元）, 成交单价（元）
```

> 📝 **自定义数据**：至少准备"成交日期、区域、成交价"三个字段即可运行核心功能。

### 数据来源

数据采集自公开的房产交易平台，经过以下处理：
- 异常值过滤
- 时间范围标准化
- 敏感信息脱敏
- 字段规范化

---

## 🔌 API 接口

> 📚 **完整文档**：[API_DOCUMENTATION.md](docs/API_DOCUMENTATION.md) | [OpenAPI 规范](docs/openapi.yaml)

### 主要接口列表

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/city/<city>/stats` | GET | 城市统计数据 |
| `/api/city/<city>/analysis` | GET | 城市分析数据 |
| `/api/ai/chat` | POST | AI 对话 |
| `/api/ai/chat-stream` | GET | AI 流式对话 |
| `/api/prediction/stats` | POST | 统计预测 |
| `/api/prediction/ai-data` | POST | AI 预测数据 |
| `/api/ai/generate-image` | POST | AI 图像生成 |
| `/api/strategy/generate` | POST | 策略生成 |

### 示例请求

```bash
# 获取城市统计
curl http://localhost:5001/api/city/beijing/stats

# AI 对话
curl -X POST http://localhost:5001/api/ai/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "北京房价走势如何？", "city": "beijing"}'

# 房价预测
curl -X POST http://localhost:5001/api/prediction/stats \
  -H "Content-Type: application/json" \
  -d '{"city": "beijing", "months": 6}'
```

---

## 📸 演示截图

### 首页概览
```
┌────────────────────────────────────────────────────┐
│  🏠 AI 驱动的智能房价分析系统                        │
├────────────────────────────────────────────────────┤
│  ┌──────────┐  ┌──────────┐  ┌──────────┐         │
│  │ 📊 32万+ │  │ 🏙️ 3城市 │  │ 🤖 AI    │         │
│  │  成交数据 │  │  数据覆盖 │  │  智能分析 │         │
│  └──────────┘  └──────────┘  └──────────┘         │
├────────────────────────────────────────────────────┤
│  城市快速导航：北京 | 武汉 | 厦门                    │
└────────────────────────────────────────────────────┘
```

### 3D 房价地图
```
          🔴🔴🔴              ← 高价区（海淀、西城）
        🟡🟡🟡🟡🟡            ← 中价区（朝阳、东城）
      🟢🟢🟢🟢🟢🟢🟢          ← 相对低价区（通州、昌平）
    ━━━━━━━━━━━━━━━━━━━━━
    时间轴：2023 ──────────▶ 2025
```

### AI 房价预测
```
    价格
    500┤                              
       │ ●───●                        
    400┤      ╲●───●                  历史价格
       │            ╲●───●            
    300┤                  ╲◆- -◆- -◆  统计预测
       │                    ╲▲━━▲━━▲  AI预测
    200┼──────────────────────────────
       2024-09    2025-03    2025-09   时间
```

---

## ❓ 常见问题

### Q: 如何添加新城市数据？

```bash
# 1. 准备 CSV 数据文件
cp 新城市数据.csv data/processed/data_newcity_2023_2025.csv

# 2. 编辑 config.json 添加城市配置
{
  "name": "新城市",
  "name_en": "newcity",
  "data_file": "data_newcity_2023_2025.csv",
  "enabled": true
}

# 3. 重启服务即可
```

### Q: AI 功能需要联网吗？

是的，AI 功能需要调用 DeepSeek API，请确保网络连接正常。

### Q: 支持哪些浏览器？

推荐使用 Chrome/Firefox/Safari/Edge 最新版，需支持 WebGL（3D 地图功能）。

### Q: 数据多久更新一次？

当前数据更新至 2025 年 8 月。如需更新，替换 `data/processed/` 目录下的 CSV 文件即可。

---

## 📈 性能指标

| 指标 | 数值 |
|------|------|
| 页面加载 | < 2 秒 |
| 数据处理（32万条） | < 3 秒 |
| AI 响应 | < 5 秒 |
| 3D 地图渲染 | < 10 秒 |

---

## 🔜 未来规划

- [ ] 添加更多城市数据
- [ ] AI 小区评估功能
- [ ] AI 议价助手
- [ ] 移动端适配
- [ ] 数据库持久化存储

---

## 🤖 AI 技术使用声明

本项目在开发和功能实现中使用了 AI 技术，特此声明：

### 开发过程中的 AI 辅助

| AI 工具 | 使用场景 | 说明 |
|---------|---------|------|
| **Cursor + Claude** | 代码编写辅助 | 辅助编写部分代码和调试，所有代码均经人工审核和理解 |
| **ChatGPT** | 技术方案讨论 | 辅助技术选型和架构设计讨论 |

### 系统功能中的 AI 集成

| AI 模型 | 功能模块 | 说明 |
|---------|---------|------|
| **DeepSeek-V3** | 智能对话、数据分析解读 | 基于用户输入实时生成分析报告 |
| **DeepSeek-V3** | 房价预测分析 | 结合历史数据生成预测和建议 |
| **FLUX.1-schnell** | 图像生成 | 生成梦想家园等创意图像（Black Forest Labs） |

### 开发者声明

1. **代码理解**：所有 AI 辅助生成的代码，开发者均能完整理解其逻辑和实现原理
2. **可修改能力**：开发者具备独立修改、调试和优化代码的能力
3. **工具定位**：AI 作为提升开发效率的工具，而非替代人工思考
4. **质量保证**：最终代码质量由开发者负责，AI 输出均经过审核

---

## 📜 数据伦理与合规声明

### 数据来源

- **数据来源**：公开房产交易平台的成交信息
- **采集时间**：2023年1月 - 2025年8月
- **采集方式**：公开数据接口 + 合规爬虫

### 合规措施

| 措施 | 说明 |
|------|------|
| **Robots 协议** | 严格遵守目标网站的 robots.txt 规定 |
| **请求频率** | 设置合理的请求间隔（≥2秒），避免对服务器造成压力 |
| **数据用途** | 仅用于学术研究和课程作业，不作商业用途 |
| **隐私保护** | 数据已脱敏处理，不包含任何个人隐私信息 |

### 数据处理

```
原始数据 → 异常值过滤 → 敏感信息脱敏 → 字段标准化 → 分析使用
```

### 免责声明

1. 本项目数据仅供学习研究使用，不构成任何投资建议
2. 数据分析结果仅供参考，实际购房决策请咨询专业人士
3. 如有数据来源方认为侵权，请联系我们删除

---

## 📄 开源协议

本项目仅供学习和研究使用。

---

## 🙏 致谢

- **AI 模型**：[DeepSeek](https://www.deepseek.com/)
- **可视化**：[Apache ECharts](https://echarts.apache.org/)
- **开发工具**：[Cursor](https://cursor.sh/)

---

<p align="center">
  <b>⭐ 如果这个项目对你有帮助，请给个 Star！</b>
</p>

<p align="center">
  Made with ❤️ by 大三 Python 课程大作业
</p>
